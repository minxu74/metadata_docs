{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"ESGF 1.5 Metadata Migration and Synchronization","text":""},{"location":"#link","title":"Link","text":""},{"location":"#design","title":"Design:","text":"<p>from ESGF-1.5-desgin </p>"},{"location":"#document","title":"Document:","text":"<ol> <li>design.md</li> <li>changes.md</li> <li>indexes.md</li> </ol>"},{"location":"Migration/","title":"Migration Status","text":""},{"location":"Migration/#progress","title":"Progress","text":"ESGF 1.5 Index Status"},{"location":"Migration/#datasets","title":"Datasets","text":"<p>Read-only Projects</p> CMIP3CMIP5CMIP6CREATE-IPe3sm-supplementGeoMIPLUCIDTAMIPGFDL-CMIP5GFDL-CMIP5 <p></p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p> <p>Read-Write Projects</p> CMIP6PlusDRCDPE3SMinput4MIPsobs4MIPs <p></p> <p></p> <p></p> <p></p> <p></p>"},{"location":"Migration/#files","title":"Files","text":"<p>Read-only Projects</p> CMIP3CMIP5CMIP6CREATE-IPe3sm-supplementGeoMIPLUCIDTAMIPGFDL-CMIP5GFDL-CMIP5 <p></p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p> <p>Read-Write Projects</p> CMIP6PlusDRCDPE3SMinput4MIPsobs4MIPs <p></p> <p></p> <p></p> <p></p> <p></p>"},{"location":"Migration/jsons/chart_project/","title":"Chart project","text":"<p>cmip3</p> <p> <pre><code>pie showData\n    title project: cmip3-datasets\n        \"ANL\" : 29331\n        \"LLNL\" : 29331\n        \"ORNL\" : 29331\n        \"IMBALANCE\" :  0</code></pre> <pre><code>pie showData\n    title project: cmip3-files\n        \"ANL\" : 82172\n        \"LLNL\" : 82172\n        \"ORNL\" : 82172\n        \"IMBALANCE\" :  0</code></pre> </p> <p>cmip5</p> <p> <pre><code>pie showData\n    title project: cmip5-datasets\n        \"ANL\" : 35148\n        \"LLNL\" : 62791\n        \"ORNL\" : 35149\n        \"IMBALANCE\" :  0</code></pre> <pre><code>pie showData\n    title project: cmip5-files\n        \"ANL\" : 1983272\n        \"LLNL\" : 4522442\n        \"ORNL\" : 2001354\n        \"IMBALANCE\" :  0</code></pre> </p> <p>cmip6</p> <p> <pre><code>pie showData\n    title project: cmip6-datasets\n        \"ANL\" : 5686552\n        \"LLNL\" : 9079331\n        \"ORNL\" : 5963081\n        \"IMBALANCE\" :  0</code></pre> <pre><code>pie showData\n    title project: cmip6-files\n        \"ANL\" : 23119490\n        \"LLNL\" : 38913051\n        \"ORNL\" : 26844447\n        \"IMBALANCE\" :  0</code></pre> </p> <p>create-ip</p> <p> <pre><code>pie showData\n    title project: create-ip-datasets\n        \"ANL\" : 0\n        \"LLNL\" : 112\n        \"ORNL\" : 0\n        \"IMBALANCE\" :  0</code></pre> <pre><code>pie showData\n    title project: create-ip-files\n        \"ANL\" : 0\n        \"LLNL\" : 39071\n        \"ORNL\" : 0\n        \"IMBALANCE\" :  0</code></pre> </p> <p>e3sm-supplement</p> <p> <pre><code>pie showData\n    title project: e3sm-supplement-datasets\n        \"ANL\" : 0\n        \"LLNL\" : 53\n        \"ORNL\" : 53\n        \"IMBALANCE\" :  0</code></pre> <pre><code>pie showData\n    title project: e3sm-supplement-files\n        \"ANL\" : 0\n        \"LLNL\" : 3172\n        \"ORNL\" : 3172\n        \"IMBALANCE\" :  0</code></pre> </p> <p>geomip</p> <p> <pre><code>pie showData\n    title project: geomip-datasets\n        \"ANL\" : 0\n        \"LLNL\" : 290\n        \"ORNL\" : 0\n        \"IMBALANCE\" :  0</code></pre> <pre><code>pie showData\n    title project: geomip-files\n        \"ANL\" : 0\n        \"LLNL\" : 14742\n        \"ORNL\" : 0\n        \"IMBALANCE\" :  0</code></pre> </p> <p>lucid</p> <p> <pre><code>pie showData\n    title project: lucid-datasets\n        \"ANL\" : 0\n        \"LLNL\" : 131\n        \"ORNL\" : 0\n        \"IMBALANCE\" :  0</code></pre> <pre><code>pie showData\n    title project: lucid-files\n        \"ANL\" : 0\n        \"LLNL\" : 16264\n        \"ORNL\" : 0\n        \"IMBALANCE\" :  0</code></pre> </p> <p>tamip</p> <p> <pre><code>pie showData\n    title project: tamip-datasets\n        \"ANL\" : 0\n        \"LLNL\" : 192\n        \"ORNL\" : 0\n        \"IMBALANCE\" :  0</code></pre> <pre><code>pie showData\n    title project: tamip-files\n        \"ANL\" : 0\n        \"LLNL\" : 4480\n        \"ORNL\" : 0\n        \"IMBALANCE\" :  0</code></pre> </p>"},{"location":"Migration/jsons/table_project/","title":"Table project","text":""},{"location":"Migration/jsons/table_project/#cmip3-datasets","title":"cmip3-datasets","text":"Index numFound Total records (skipped records) Ingested (Entries) ANL 29331 29331(0) 29331 LLNL 29331 29331(0) 29331 ORNL 29331 29331(0) 29331 PUBLIC 87993(87993)"},{"location":"Migration/jsons/table_project/#cmip3-files","title":"cmip3-files","text":"Index numFound Total records (skipped records) Ingested (Entries) ANL 82172 82172(0) 82172 LLNL 82172 82172(0) 82172 ORNL 82172 82172(0) 82172 PUBLIC 246516(246516)"},{"location":"Migration/jsons/table_project/#cmip5-datasets","title":"cmip5-datasets","text":"Index numFound Total records (skipped records) Ingested (Entries) ANL 35148 35148(0) 35148 LLNL 62791 62791(0) 62791 ORNL 57109 57109(21960) 35149 PUBLIC 133088(133088)"},{"location":"Migration/jsons/table_project/#cmip5-files","title":"cmip5-files","text":"Index numFound Total records (skipped records) Ingested (Entries) ANL 1983272 1983272(0) 1983272 LLNL 4522442 4522442(0) 4522442 ORNL 3711854 3711854(1710500) 2001354 PUBLIC 8507068(8507068)"},{"location":"Migration/jsons/table_project/#cmip6-datasets","title":"cmip6-datasets","text":"Index numFound Total records (skipped records) Ingested (Entries) ANL 5686552 5686552(0) 5686552 LLNL 9080328 9080328(997) 9079331 ORNL 9037273 9037273(3074192) 5963081 PUBLIC 20728964(20728964)"},{"location":"Migration/jsons/table_project/#cmip6-files","title":"cmip6-files","text":"Index numFound Total records (skipped records) Ingested (Entries) ANL 23119490 23119490(0) 23119490 LLNL 38921810 38921810(8759) 38913051 ORNL 36278980 36278980(9434533) 26844447 PUBLIC 88876988(88876988)"},{"location":"Migration/jsons/table_project/#create-ip-datasets","title":"create-ip-datasets","text":"Index numFound Total records (skipped records) Ingested (Entries) ANL 0 0(0) 0 LLNL 112 112(0) 112 ORNL 112 112(112) 0 PUBLIC 112(112)"},{"location":"Migration/jsons/table_project/#create-ip-files","title":"create-ip-files","text":"Index numFound Total records (skipped records) Ingested (Entries) ANL 0 0(0) 0 LLNL 39071 39071(0) 39071 ORNL 39071 39071(39071) 0 PUBLIC 39071(39071)"},{"location":"Migration/jsons/table_project/#e3sm-supplement-datasets","title":"e3sm-supplement-datasets","text":"Index numFound Total records (skipped records) Ingested (Entries) ANL 0 0(0) 0 LLNL 53 53(0) 53 ORNL 53 53(0) 53 PUBLIC 106(106)"},{"location":"Migration/jsons/table_project/#e3sm-supplement-files","title":"e3sm-supplement-files","text":"Index numFound Total records (skipped records) Ingested (Entries) ANL 0 0(0) 0 LLNL 3172 3172(0) 3172 ORNL 3172 3172(0) 3172 PUBLIC 6344(6344)"},{"location":"Migration/jsons/table_project/#geomip-datasets","title":"geomip-datasets","text":"Index numFound Total records (skipped records) Ingested (Entries) ANL 0 0(0) 0 LLNL 290 290(0) 290 ORNL 290 290(290) 0 PUBLIC 290(290)"},{"location":"Migration/jsons/table_project/#geomip-files","title":"geomip-files","text":"Index numFound Total records (skipped records) Ingested (Entries) ANL 0 0(0) 0 LLNL 14742 14742(0) 14742 ORNL 14742 14742(14742) 0 PUBLIC 14742(14742)"},{"location":"Migration/jsons/table_project/#lucid-datasets","title":"lucid-datasets","text":"Index numFound Total records (skipped records) Ingested (Entries) ANL 0 0(0) 0 LLNL 131 131(0) 131 ORNL 131 131(131) 0 PUBLIC 131(131)"},{"location":"Migration/jsons/table_project/#lucid-files","title":"lucid-files","text":"Index numFound Total records (skipped records) Ingested (Entries) ANL 0 0(0) 0 LLNL 16264 16264(0) 16264 ORNL 16264 16264(16264) 0 PUBLIC 16264(16264)"},{"location":"Migration/jsons/table_project/#tamip-datasets","title":"tamip-datasets","text":"Index numFound Total records (skipped records) Ingested (Entries) ANL 0 0(0) 0 LLNL 192 192(0) 192 ORNL 192 192(192) 0 PUBLIC 192(192)"},{"location":"Migration/jsons/table_project/#tamip-files","title":"tamip-files","text":"Index numFound Total records (skipped records) Ingested (Entries) ANL 0 0(0) 0 LLNL 4480 4480(0) 4480 ORNL 4480 4480(4480) 0 PUBLIC 4480(4480)"},{"location":"Notes/notes/","title":"Notes","text":"<ol> <li> <p>The Solr query in the migration uses the cursor query method, and the <code>cursorMark</code> from the cursor query is recorded in a migration database and is used for restart purposes.</p> </li> <li> <p>The cursor query needs special permissions to the Solr indexes, i.e., the IP address of the machine in which the cursor query is made needs to be included in the white-lists of the indexes.</p> </li> <li> <p>There are <code>project=cmip6</code> and <code>project=CMIP6</code>, <code>project=e3sm</code> and <code>project=E3SM</code>. It found that lower case <code>cmip6</code> and upper case <code>E3SM</code> were used by the retracted documents, so only the <code>CMIP6</code> and <code>e3sm</code> were migrated to the Globus indexes.</p> </li> <li> <p>Generally, the size of 500 documents for the CMIP projects is much less than the maximum size (10 MB) for ingestion. However, for <code>project=e3sm</code> and <code>project=e3sm-supplement</code>,  the size of 500 documents is larger than 10 MB, so we use <code>rows=100</code> in the migration of <code>e3sm</code> and <code>e3sm-supplement</code> projects, and 1500 for other projects.</p> </li> <li> <p>Changes to the Solr document:</p> <ul> <li>change the value of the <code>index_node</code> to us_index</li> <li>remove the <code>url</code> item if the type of document is <code>Datsets</code></li> </ul> </li> <li> <p>Filters during the migration:</p> <ul> <li>filter out all metadata at the ORNL index if the value of <code>data_node</code> does not include <code>anl.gov</code> and <code>llnl.gov</code> and does not equal <code>esgf-node.ornl.gov</code></li> <li>filter out all metadata at the LLNL index when the <code>source_id=E3SM-2-1</code></li> </ul> </li> <li> <p>The metadata of <code>project=e3sm</code> at the ORNL index shall be discarded as the metadata was migrated to the ORNL index, but the actual files were not. But half of these metadata have been ingested to the E3SM staged index.</p> </li> <li> <p>The formats of the <code>_timestamp</code> strings may differ as there are two APIs to generate them during the publications (<code>YYYY-MM-DDThh:mm:ss.sssZ</code> vs. <code>YYYY-MM-DDThh:mm:ssZ</code>).</p> <ul> <li>A legacy API for harvesting thredds catalogs and generating publication records</li> <li>the \"push\" publisher API (esg-publisher)</li> </ul> </li> <li> <p>The solr query used in the migration only searches the default local shard with port 8983, there is another local shard with port 8995 that is only used for GFDL CMIP6 data </p> </li> <li> <p>The other shards shown in the LLNL esg_search, are the \"replica\" shards at LLNL and are the synced copies of the remote shards. However, the GFDL's remote shard is dead, thus, the GFDL local replica shard (port: 8895) could be considered a local shard for migration purposes.</p> </li> <li> <p>The esg search using the LLNL index is the distributed query by default, however, the distributed shards do not include the ANL and ORNL solr index.  The esg search using the ANL or ORNL indexes only searches their local shards even when <code>distrib=True</code>.</p> </li> <li> <p>The Solr query string used in the migration:</p> <ul> <li>query the default shard (for ANL, LLNL and ORNL default shard with port 8983)       <pre><code>select?sort=id+asc&amp;rows=500&amp;cursorMark=*&amp;wt=json&amp;q=project:CMIP6&amp;fq=_timestamp:[* TO 2025-03-16T00:00:00Z]\n</code></pre></li> <li>query the additional local shard (only for LLNL index and the shard is used to save the GFDL metadata)       <pre><code>select?sort=id+asc&amp;rows=500&amp;cursorMark=*&amp;wt=json&amp;q=project:CMIP6&amp;fq=_timestamp:[* TO 2025-03-16T00:00:00Z]&amp;shards=localhost:8995/solr/datasets\n</code></pre></li> </ul> </li> <li> <p>The esg search query string used in the verfication:</p> <ul> <li> <p>query the default shard (for ANL, LLNL and ORNL default shard with port 8983)       <pre><code>search?query=project:CMIP6&amp;limit=500&amp;from=*&amp;to=2025-03-16T00:00:00Z&amp;format=application%2Fsolr%2Bjson&amp;distrib=false\n</code></pre></p> </li> <li> <p>query the additional local shard (only for LLNL index and the shard is used to save the GFDL metadata)       <pre><code>search?query=project:CMIP6&amp;limit=500&amp;from=*&amp;to=2025-03-16T00:00:00Z&amp;format=application%2Fsolr%2Bjson&amp;distrib=true&amp;shards=localhost:8995/solr\n</code></pre></p> </li> </ul> </li> </ol>"},{"location":"Synchronization/","title":"Synchronization Status","text":""},{"location":"Synchronization/#datasets-and-files","title":"Datasets and Files","text":"<p>Read-Write Projects</p> CMIP6PlusDRCDPE3SMinput4MIPsobs4MIPs <p></p> <p></p> <p></p> <p>Note</p> <p>Hold the E3SM sync. See Notes </p> <p></p> <p></p>"},{"location":"Validation/","title":"Validation and Verification","text":""},{"location":"Validation/#project-level","title":"Project level","text":"<p>cmip3</p> <p> <pre><code>pie showData\n    title project: cmip3-datasets\n        \"ANL\" : 29331\n        \"LLNL\" : 29331\n        \"ORNL\" : 29331\n        \"IMBALANCE\" :  0</code></pre> <pre><code>pie showData\n    title project: cmip3-files\n        \"ANL\" : 82172\n        \"LLNL\" : 82172\n        \"ORNL\" : 82172\n        \"IMBALANCE\" :  0</code></pre> </p> <p>cmip5</p> <p> <pre><code>pie showData\n    title project: cmip5-datasets\n        \"ANL\" : 35148\n        \"LLNL\" : 62791\n        \"ORNL\" : 35149\n        \"IMBALANCE\" :  0</code></pre> <pre><code>pie showData\n    title project: cmip5-files\n        \"ANL\" : 1983272\n        \"LLNL\" : 4522442\n        \"ORNL\" : 2001354\n        \"IMBALANCE\" :  0</code></pre> </p> <p>cmip6</p> <p> <pre><code>pie showData\n    title project: cmip6-datasets\n        \"ANL\" : 5686552\n        \"LLNL\" : 9079331\n        \"ORNL\" : 5963081\n        \"IMBALANCE\" :  0</code></pre> <pre><code>pie showData\n    title project: cmip6-files\n        \"ANL\" : 23119490\n        \"LLNL\" : 38913051\n        \"ORNL\" : 26844447\n        \"IMBALANCE\" :  0</code></pre> </p> <p>create-ip</p> <p> <pre><code>pie showData\n    title project: create-ip-datasets\n        \"ANL\" : 0\n        \"LLNL\" : 112\n        \"ORNL\" : 0\n        \"IMBALANCE\" :  0</code></pre> <pre><code>pie showData\n    title project: create-ip-files\n        \"ANL\" : 0\n        \"LLNL\" : 39071\n        \"ORNL\" : 0\n        \"IMBALANCE\" :  0</code></pre> </p> <p>e3sm-supplement</p> <p> <pre><code>pie showData\n    title project: e3sm-supplement-datasets\n        \"ANL\" : 0\n        \"LLNL\" : 53\n        \"ORNL\" : 53\n        \"IMBALANCE\" :  0</code></pre> <pre><code>pie showData\n    title project: e3sm-supplement-files\n        \"ANL\" : 0\n        \"LLNL\" : 3172\n        \"ORNL\" : 3172\n        \"IMBALANCE\" :  0</code></pre> </p> <p>geomip</p> <p> <pre><code>pie showData\n    title project: geomip-datasets\n        \"ANL\" : 0\n        \"LLNL\" : 290\n        \"ORNL\" : 0\n        \"IMBALANCE\" :  0</code></pre> <pre><code>pie showData\n    title project: geomip-files\n        \"ANL\" : 0\n        \"LLNL\" : 14742\n        \"ORNL\" : 0\n        \"IMBALANCE\" :  0</code></pre> </p> <p>lucid</p> <p> <pre><code>pie showData\n    title project: lucid-datasets\n        \"ANL\" : 0\n        \"LLNL\" : 131\n        \"ORNL\" : 0\n        \"IMBALANCE\" :  0</code></pre> <pre><code>pie showData\n    title project: lucid-files\n        \"ANL\" : 0\n        \"LLNL\" : 16264\n        \"ORNL\" : 0\n        \"IMBALANCE\" :  0</code></pre> </p> <p>tamip</p> <p> <pre><code>pie showData\n    title project: tamip-datasets\n        \"ANL\" : 0\n        \"LLNL\" : 192\n        \"ORNL\" : 0\n        \"IMBALANCE\" :  0</code></pre> <pre><code>pie showData\n    title project: tamip-files\n        \"ANL\" : 0\n        \"LLNL\" : 4480\n        \"ORNL\" : 0\n        \"IMBALANCE\" :  0</code></pre> </p>"},{"location":"Validation/#cmip3-datasets","title":"cmip3-datasets","text":"Index numFound Total records (skipped records) Ingested (Entries) ANL 29331 29331(0) 29331 LLNL 29331 29331(0) 29331 ORNL 29331 29331(0) 29331 PUBLIC 87993(87993)"},{"location":"Validation/#cmip3-files","title":"cmip3-files","text":"Index numFound Total records (skipped records) Ingested (Entries) ANL 82172 82172(0) 82172 LLNL 82172 82172(0) 82172 ORNL 82172 82172(0) 82172 PUBLIC 246516(246516)"},{"location":"Validation/#cmip5-datasets","title":"cmip5-datasets","text":"Index numFound Total records (skipped records) Ingested (Entries) ANL 35148 35148(0) 35148 LLNL 62791 62791(0) 62791 ORNL 57109 57109(21960) 35149 PUBLIC 133088(133088)"},{"location":"Validation/#cmip5-files","title":"cmip5-files","text":"Index numFound Total records (skipped records) Ingested (Entries) ANL 1983272 1983272(0) 1983272 LLNL 4522442 4522442(0) 4522442 ORNL 3711854 3711854(1710500) 2001354 PUBLIC 8507068(8507068)"},{"location":"Validation/#cmip6-datasets","title":"cmip6-datasets","text":"Index numFound Total records (skipped records) Ingested (Entries) ANL 5686552 5686552(0) 5686552 LLNL 9080328 9080328(997) 9079331 ORNL 9037273 9037273(3074192) 5963081 PUBLIC 20728964(20728964)"},{"location":"Validation/#cmip6-files","title":"cmip6-files","text":"Index numFound Total records (skipped records) Ingested (Entries) ANL 23119490 23119490(0) 23119490 LLNL 38921810 38921810(8759) 38913051 ORNL 36278980 36278980(9434533) 26844447 PUBLIC 88876988(88876988)"},{"location":"Validation/#create-ip-datasets","title":"create-ip-datasets","text":"Index numFound Total records (skipped records) Ingested (Entries) ANL 0 0(0) 0 LLNL 112 112(0) 112 ORNL 112 112(112) 0 PUBLIC 112(112)"},{"location":"Validation/#create-ip-files","title":"create-ip-files","text":"Index numFound Total records (skipped records) Ingested (Entries) ANL 0 0(0) 0 LLNL 39071 39071(0) 39071 ORNL 39071 39071(39071) 0 PUBLIC 39071(39071)"},{"location":"Validation/#e3sm-supplement-datasets","title":"e3sm-supplement-datasets","text":"Index numFound Total records (skipped records) Ingested (Entries) ANL 0 0(0) 0 LLNL 53 53(0) 53 ORNL 53 53(0) 53 PUBLIC 106(106)"},{"location":"Validation/#e3sm-supplement-files","title":"e3sm-supplement-files","text":"Index numFound Total records (skipped records) Ingested (Entries) ANL 0 0(0) 0 LLNL 3172 3172(0) 3172 ORNL 3172 3172(0) 3172 PUBLIC 6344(6344)"},{"location":"Validation/#geomip-datasets","title":"geomip-datasets","text":"Index numFound Total records (skipped records) Ingested (Entries) ANL 0 0(0) 0 LLNL 290 290(0) 290 ORNL 290 290(290) 0 PUBLIC 290(290)"},{"location":"Validation/#geomip-files","title":"geomip-files","text":"Index numFound Total records (skipped records) Ingested (Entries) ANL 0 0(0) 0 LLNL 14742 14742(0) 14742 ORNL 14742 14742(14742) 0 PUBLIC 14742(14742)"},{"location":"Validation/#lucid-datasets","title":"lucid-datasets","text":"Index numFound Total records (skipped records) Ingested (Entries) ANL 0 0(0) 0 LLNL 131 131(0) 131 ORNL 131 131(131) 0 PUBLIC 131(131)"},{"location":"Validation/#lucid-files","title":"lucid-files","text":"Index numFound Total records (skipped records) Ingested (Entries) ANL 0 0(0) 0 LLNL 16264 16264(0) 16264 ORNL 16264 16264(16264) 0 PUBLIC 16264(16264)"},{"location":"Validation/#tamip-datasets","title":"tamip-datasets","text":"Index numFound Total records (skipped records) Ingested (Entries) ANL 0 0(0) 0 LLNL 192 192(0) 192 ORNL 192 192(192) 0 PUBLIC 192(192)"},{"location":"Validation/#tamip-files","title":"tamip-files","text":"Index numFound Total records (skipped records) Ingested (Entries) ANL 0 0(0) 0 LLNL 4480 4480(0) 4480 ORNL 4480 4480(4480) 0 PUBLIC 4480(4480)"},{"location":"Validation/#institution_id-level","title":"institution_id level","text":""},{"location":"Validation/#source_id-level","title":"source_id level","text":""}]}